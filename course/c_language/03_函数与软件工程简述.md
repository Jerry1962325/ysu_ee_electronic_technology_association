## 函数

函数是C语言实现代码复用的基本单元，C语言的函数可以有多个输入，一个输出

最简单的函数即没有输入也没有输出

```C
#include <stdio.h>

void greet() {
    printf("Hello!\n");
}

int main() {
    greet();
    return 0;
}
```

void表示没有输出(返回值)，greet后面的小括号里为空，表示函数没有输入

一般来说，一个函数既有输入也有输出，例如写一个计算向量模长的函数

```C
#include <stdio.h>
#include <math.h>

// 函数在使用之前必须先定义
// 定义了函数length，输入两个参数均为浮点型，分别叫vec_x,，vec_y
// 输出浮点型
float length(float vec_x, float vec_y) {
    return sqrt(vec_x * vec_x + vec_y * vec_y); 
    // 使用return来输出结果并结束函数
}

int main() {
    float a, b, c;
    a = 3;
    b = 4;
    c = length(a, b);   // 变量c被复制为length函数的返回值
    printf("勾%d股%d弦%d\n", (int)a, (int)b, (int)c);
    return 0;
}
```

在length函数中，vec_x和vec_y被称为形式参数，a和b被称为实际参数

在调用函数时，会将实际参数**按序**赋值给形式参数

### 画函数图像

```C
#include <stdio.h>
#include <math.h>
#include <stdbool.h>

// x轴方向的字符数
#define X_CHARS 41
// y轴方向的字符数
#define Y_CHARS 41
// x轴缩放倍率的倒数
#define X_SCALE_INV 0.2
// y轴缩放倍率的倒数
#define Y_SCALE_INV 0.1
// 容许误差半径
// 当容许误差半径正好是y轴缩放倍率倒数的一半时，线宽正好为一个方形字符(两个英文半角字符)
#define EPSILON ((Y_SCALE_INV) / 2.0)

bool in_radius(float x, float y) // 两个浮点数`差不多`相等
{
    return fabsf(x - y) <= EPSILON;
}

// 圆方程
float circle(float x, float y) // x^2 + y^2 = 1 变换为 F(x,y) = x^2 + y^2 - 1
{
    return sqrtf(powf(x, 2) + powf(y, 2)) - 1;
}

// 正弦函数方程
float wave(float x, float y) // y = sin(x) 变换为 F(x,y) = sin(x) - y
{
    return sinf(x) - y;
}

int main()
{
    float x, y;
    for (int i = 0; i <= Y_CHARS; i++)
    {
        for (int j = 0; j <= X_CHARS; j++)
        {
            x = (j - X_CHARS / 2) * X_SCALE_INV;
            y = -(i - Y_CHARS / 2) * Y_SCALE_INV;
            if (in_radius(wave(x, y), 0))
            {
                printf("**");
            }
            else
            {
                printf("  ");
            }
        }
        printf("\n");
    }
    return 0;
}
```

运行这段代码，黑框框会输出 $y = sin(x)$ 的图像，这段代码实现了绘制函数图像的功能

- 尝试将输出图像换成圆

- 尝试改变宏定义的参数，了解它们的功能

- 尝试绘制$y^2 = x^3 - x + 1$的函数图像(缩放倍率设置为0.1，加大线宽)

注意到了吗？在命名宏常量时使用了全大写英文加下划线，一般来说，用全大写命名常量

### 调试

搞不懂程序为什么能运行？搞不懂程序为什么不能运行？你需要调试！

一只小飞蛾钻进了计算机电路里，导致系统无法工作，于是，bug一词成了电脑系统程序的专业术语，形容那些系统中的缺陷或问题。

`debug`直译为去虫，意译为调试

将`编译器配置方案`调整为`debug`模式，`编译/链接选项`中的`代码生成`中的`优化级别`改成`Debug (-Og)`

以绘制函数图像的程序为例，在内层循环代码块的第一行处右键选择`切换断点`，你会看到行号左边有一个红点

点击虫子形状的按钮，代码会运行到断点处停下，找到下方的调试栏，选择局部变量一栏，可以看到所有局部变量和其对应的值

蓝色箭头是程序指针，标识着程序运行到哪一行。注意：蓝色指针指向的一行还没有运行完成

在虫子按钮右边的几个按钮可以控制程序继续执行

`单步跨过`，运行一行，如果有函数调用，不进入函数

`单步进入`，运行一行，如果有函数调用，进入函数内部(如果函数是标准库中的，你可能会面对汇编代码)

`单步跳出`，跳出当前执行的函数，返回调用函数的一行

`调用栈`记录了函数之间的调用关系，调用栈的最底下一定是`main`函数，在调用`wave`函数时，`wave`函数会在`main`函数上方，表示`main`调用了`wave`

### 递归